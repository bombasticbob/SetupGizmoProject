<HTML>
<HEAD>
<META NAME="GENERATOR" Content="gedit">
<TITLE>SETUP.INF file format</TITLE>
</HEAD>
<BODY>
<H1>SETUP.INF file format</H1>
<br />
<p>
SETUP.EXE uses a file named 'SETUP.INF' to control all of its behavior.  This file is generated by 'MAKECAB.EXE', which is run by SETUPGIZ.EXE using a temporary output file 'SETUPGIZ.DDF' that is placed into the 'output' directory, and deleted upon completion.  In the event of an error, SETUPGIZ.EXE does not delete 'SETUPGIZ.DDF'.  If you want to manually edit 'SETUPGIZ.DDF' and run 'MAKECAB.EXE', the command line it uses is:
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MAKECAB /V3 /F SETUPGIZ.DDF
</p>
<p>
The output of 'MAKECAB' is the file _SETUP.INF, which is copied into the appropriate location as SETUP.INF, such as into the 'DISK1' directory of a diskette image.
</p>
<p>
Without going into detail on how 'MAKECAB' works (for information on MAKECAB, download Microsoft's 'CAB SDK' from the Microsoft web site, www.microsoft.com), MAKECAB generates the INF file using commands in the 'SETUPGIZ.DDF' file, showing which cabinet files exist, their names, the name(s) of the disk(ettes),  plus information that SETUP will need to run properly.
</p>
<p>
If you examine the 'SETUP.INF' file in the application's 'Uninstall' directory (see 'uninst' under <a href="specifying_paths.html">Specifying Paths</a>), you will see the appropriate sections.  In some cases you may want to edit this file yourself.  Its sections are described below:
<p>
<table>
<tr><td valign=top><b>[disk list]</b></td><td>
The disk number and disk label for each disk.  SETUP uses this to prompt for which diskette to enter.  For standard CDROM and 'self-extracting' installations, there will only be 1.
</td></tr>
<tr><td valign=top><b>[cabinet list]</b></td><td>
Like the disk list, above, the cabinet list lists all 'cab' files, giving the cabinet number, disk number, and file name.
</td></tr>
<tr><td valign=top><b>[Files]</b></td><td>
This section contains a list of file names, one per row, with comma-separated parameters.  The first is the disk #, the 2nd is the cabinet number, followed by the file name, the destination path (if not the 'application path'), the file date, and the file size.
</td></tr>
<tr><td valign=top><b>[Files.Win95]<br />[Files.Win98]<br />[Files.WinNT4]<br />[Files.Win2000]<br /></b>(etc.)</td><td valign=top>
These sections are formatted the same as the 'files' section, but contain files that are specific to one of the supported operating systems, such as Windows '95, Windows '98, Windows NT 4.x, Windows 2000, etc..<br />
<b>NOTE:</b>  If the version of the OS on which you are installing exceeds the highest known version, the information for the highest known operating system version will be used.
</td></tr>
<tr><td valign=top><b>[Options]</b></td><td>
This section contains a list of install options.  Each entry is 3 columns:  The internal option name (such as 'TestDatabase'), the 'short description' (such as &quot;The Test Database&quot;), and the 'long description' (such as &quot;This option installs the test database so that you may experiment with the application&quot;).  The short and long descriptions will appear in a 'YESNOCANCEL' message box in which the user is prompted whether he wants to install that option, for each option listed here.
</td></tr>
<tr><td valign=top><b>[Option.{option_name}]</b></td><td>
These sections contain files associated with an option.  Options may also have operating system tags appended to them, as the 'files' section does.  As such, the options section for 'TestDatabase' under Windows NT 4.0 would be '[Option.TestDatabase.WinNT4]'.
</td></tr>
<tr><td valign=top><b>[RegistryKeys]</b></td><td>
This contains a list of all registry keys to add during SETUP.  Registry keys undergo text substitution for macros like '%apppath%', etc. 
</td></tr>
<tr><td valign=top><b>[SetupOptions]</b></td><td>
This section identifies the product for SETUP.  It contains the startup message, company name, product name, and the default application path, default application common path, and default start menu folder name.  Two additional flags, 'NoUninstall' and 'QuietSetup' modify the operation of SETUP.
</td></tr>
<tr><td valign=top><b>[UnInstall]</b></td><td>
This section contains the destination path names (with directory macros) for each file to be uninstalled.
</td></tr>
<tr><td valign=top><b>[SharedComponents]</b></td><td>
These are the 'shared' components.  SETUP will register them under 'SharedDLLs' and treat them slightly different if a conflict arises.
</td></tr>
<tr><td valign=top><b>[OverwriteAlways]</b></td><td>
These files always overwrite whatever matching file is located in the destination directory, regardless of version or file date.
</td></tr>
<tr><td valign=top><b>[ExecuteAfterCopy]</b></td><td>
These files are executed after all files have been extracted and copied to their appropriate destination.
</td></tr>
<tr><td valign=top><b>[RegisterControl]</b></td><td>
These files must be registered using the 'DllRegisterServer()' export.  SETUP calls this before executing any 'execute after copy' files, and after extracting all of the files.
</td></tr>
<tr><td valign=top><b>[AddShortcut]</b></td><td>
These entries provide information on how to create a shortcut for each file that gets one when the user selects &quot;Add to Start Menu&quot;.
</td></tr>
<tr><td valign=top><b>[AutoDelete]</b></td><td>
Files in this section are automatically deleted after all 'ExecuteAfterCopy' EXE's have run, but before SETUP displays the 'SETUP has completed' dialog box.
</td></tr>
</table>
<br />
<hr size=2 width=100%>
<br />
</BODY>
</HTML>

